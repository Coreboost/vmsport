-------------------------------------------------------------------------------

               Introducing HBL, the Horse Betting Language
               ===========================================
The Horse Betting Language is a proposed language for defining executable test
specifications for the betting system. This file is both a description of HBL
and an example of what a test specification written in HBL can look like.

A multi-line comment, like this one, can be inserted by having at least three
hyphens on a line. Note that you cannot have anything before or after the
hyphens. Note the full line with hyphens that is before and after the text you
currently are reading. That is what makes this a comment.
-------------------------------------------------------------------------------

-- In addition to multi-line comments you can have single line comments that
-- last through the end of the line. Single line comments can start anywhere on
-- the line, i.e., you can have keywords, definitions or similar in the
-- beginning of the line followed by a comment.

------------------------------------------------------------------------------

                           Concepts
                           ========
There are a number of concepts that are supported directly in HBL that allows
you to, in a compact and a for the domain natural way, define test data and test
scenarios. The following are the most important concepts in HBL.

Accounts
Defines betting accounts that can be used to place bets and the funds available
for betting.

Horses
Defines identity of horses that can race. A rank can optionally be defined for a
horse which is used in the lack of reserves selected by the better.

Tracks
Defines what tracks exists.

Race calendar
Defines the racing calendar, i.e., which races that will take place at which
tracks, the number of legs, horses in each race and how different types of
betting pools are mapped to the different races.

Race days
Defines, for a particular race day, what bets that are made, and what the
results where for each leg. You can also define checks, i.e., this Defines
whether a particular test passes or fails. Bets and results will be applied in
strict order but you cannot specify, for example, the exact time a bet is made
nor the specific time that a result becomes official. You can, however mix Bets,
Results, and Checks freely. Any bet that is made at an illegal point in time
(i.e. a bet on V5 after the first leg) is caught by the HBL validator.

Note that the order is significant in that you always must structure things in
the order Accounts, Horses, Tracks, Race calendar, Race days

              Structuring your test specification with Include
              ================================================
Typically when you write test specifications you will find that you want to
use the same accounts, same horses and so on in different test specifications.
To help with this you can put, for example, your account definitions in a
separate file and include them in different test specificiations with the
Include directive.

It looks like this:
Include: <path_name>

<path_name> is the relative path to the included file starting from the location
of the current file. If the path contains spaces it needs to be enclosed in
double(") or single quoutes (').

                               Lists
                               =====
When you create a test specification in HBL you will often find that you specify
a list of some kind. Examples of this include listing the accounts eligible for
betting, listing the legs in a particular race, listing the results in a race
and so on.

All lists have a similar form in HBL. The list starts out with a keyword
followed by a colon(:). After the initial keyword follows a list of items.
List items are separated by commas and a period ends the list.

Example: when defining a race day you Would define that legs 2, 3, and 4
constitutes a V3 on that particular race day.
V3: 2, 3, 4.

Below follows a few examples of how you use the Horse Betting Language.
------------------------------------------------------------------------------

Accounts
  AA1       100  -- Create 1 account AA1 with 100 in funds.
  AA2       400
  AA[4-10]  600.  -- Create 7 accounts AA4, AA5...AA10 with 600 in funds.

Horses
  HH1    1  -- The number is the relative ranking, if two horses have the same
  HH2    3  -- rank then the start number in the race will be used as their
  HH3    5.  -- relative rank.

Tracks
  Solvalla   -- If the name of the track contains spaces they must be quoted
  "Åby"      -- otherwise quoting is optional.
  Bergsåker.

Program Solvalla 2016-02-01
  Tvilling-Legs 2.
  Trio-Legs     1.
  DD-Legs       1, 2.
  V3-Legs       3, 4, 5.
  V5-Legs       1, 2, 3, 4, 5.
  V64-Legs      1, 2, 3, 4, 5, 6.
  V65-Legs      1, 2, 3, 4, 5, 6.
  V75-Legs      1, 2, 3, 4, 5, 6, 7.
  V86-Legs      1, 2, 3, 4, 5, 6, 7, 8.

  Leg 1 HH1, HH2, HH3.
  Leg 2 .

Meeting Solvalla 2016-02-01

--------------------------------------------------------------------------------
                                Double
Below is an example of making a bet on DD. DDB1 is the id of the bet and must be
a unique string, if the id contains blanks it must be enclosed in double quotes.
10 is the bet amount per combination.

You can then, optionally, specify that the bet is tied to a particular account.
If no account is specified then it is a traditional cash bet with a receipt that
is independent of any account.

Finally you specify the selected horses for each of the legs in the DD. You can
also specify an A to indicate that you select all the horses in the particular
leg.
--------------------------------------------------------------------------------
  DD-Bet DDB1 10 Account AA1
    DD-1 2, 3.
    DD-2 A.

--------------------------------------------------------------------------------
                           Double Fortuna
Below is an example of making a Fortuna bet on DD. This is similar to a regular
DD with the following differences:
* Instead of a bet amount per combination, you specify the total maximum amount
  for the bet.
* For each leg you can either:
  * let Fortuna select the horses, in this case you simply leave the leg out
    in the specification.
  * Specify all horses yourself, in this case you simply list the numbers.
  * Specify some horses but keep it open fir  Fortuna to add additional horses
    for the leg. In this case you add an O to the end of the list of horses.
  * Specify an A to select all of the horses in the race.
--------------------------------------------------------------------------------
  DD-Bet DDB2 Fortuna 100
    DD-1 2, 3.
    DD-2 3 O.

--------------------------------------------------------------------------------
                    Lunch Double and Lunch Double Fortuna
--------------------------------------------------------------------------------
-- No example provided, see Double and Double Fortuna above instead.

--------------------------------------------------------------------------------
                                V3
Below is an example of making a bet on V3. V3B1 is the id of the bet and must be
a unque string, if the id contains blanks it must be enclosed in double quotes.
X2 is the size of the bet, i.e., the coupons in this case. Valid values are X1,
X2, X3, X4, X5, X10, X50, or X100. If you omit the size it will defaults to X1

You can then, optionally, specify that the bet is tied to a particular account.
If no account is specified then it is a traditional cash bet with a receipt that
is independent of any account.

Finally you specify the selected horses for each of the legs in the V3.
--------------------------------------------------------------------------------
  Bet V3: V3B1, X2.
    Account: AA1.     -- The bet should be tied to the account AA1.
    V3-1: 2, 3.       -- Select horses 2 and 3 for this leg
    V3-2: 1.
    V3-3: 1.

--------------------------------------------------------------------------------
                                 V4
A V4 bet is specified in much the same way as a V3 bet. The difference, in
addition to covering four legs instead of 3, is that you for each leg can
specify up to two reserves for each leg. For each leg you first list the
primary horses and then preceeded by an R you list the reserves.
--------------------------------------------------------------------------------
  Bet V4: V4B1, X2.
    V4-1: 2, 3 R 4, 5.
    V4-2: 1 R 2, 3.
    V4-3: 1 R 2, 3.
    V4-4: 2, 3 R 6, 7.

--------------------------------------------------------------------------------
                              V4 Fortuna
A Fortuna V4  is similar to a regular V4 with the following differences:
* You cannot specify a multiplier (X2, X3 and so on) for a Fortuna bet.
* You must specify an amount for the Fortuna bet.
* You cannot specify reserves.
* For each leg you can either:
  * let Fortuna select the horses, in this case you simply leave the leg out
    in the specification.
  * Specify all horses yourself, in this case you simply list the numbers.
  * Specify some horses but allow Fortuna to add additional horses for the leg.
    in this case you add an A to the end of the list of horses.
--------------------------------------------------------------------------------
  Bet V4: V4B2, Fortuna 50.
    V4-1: 2.
    V4-4: 3 A.

--------------------------------------------------------------------------------
                                V5
A V5 bet is specified in the same way as a V4 bet with the obvious difference
that there also is a fifth leg. One additional differences is that you cannot
specify the X3, and X4 multipliers on a V5 but only X1, X2, X5, X10, X20, X50,
and X100.
--------------------------------------------------------------------------------
-- No example provided, see V4 above instead.

--------------------------------------------------------------------------------
                            V5 Fortuna
A V5 Fortuna bet is specified in the same way as a V4 bet with the obvious
difference that there also is a fifth leg.
--------------------------------------------------------------------------------
-- No example provided, see V4 Fortuna above instead.

--------------------------------------------------------------------------------
                                  V64/V6
A V64 bet is specified in the same way as a V4 bet with the following
differences:
* There are 6 legs instead of 4
* You can select to make the bet a V6 rather than a V64, in that case you simply
  specify the bet type as V64/6 rather than V64.
--------------------------------------------------------------------------------
  Bet V64/6: V64B1.
    Account AA2.
    V64-1: 2, 3 R 4, 5.
    V64-2: 1 R 2, 3.
    V64-3: 1 R 2, 3.
    V64-4: 2, 3 R 6, 7.
    V64-5: 2, 3 R 6, 7.
    V64-6: 2, 3 R 6, 7.

--------------------------------------------------------------------------------
                            V64 Fortuna
A V64 Fortuna bet is specified in the same way as a V4 Fortuna bet with the
following difference:
* There are 6 legs instead of 4
A V64 Fortuna cannot be played as a V6.
--------------------------------------------------------------------------------
-- No example provided, see V4 Fortuna above instead.

--------------------------------------------------------------------------------
                               V65/V6
A V65 bet is specified in the same way as a V4 bet with the following
differences:
* There are 6 legs instead of 4
* You can select to make the bet a V6 rather than a V65, in that case you simply
 specify the bet type as V65/6 rather than V65.
--------------------------------------------------------------------------------
-- No example provided, see V4 above instead.

--------------------------------------------------------------------------------
                              V65 Fortuna
A V65 Fortuna bet is specified in the same way as a V4 Fortuna bet with the
following difference:
* There are 6 legs instead of 4
A V65 Fortuna cannot be played as a V6.
--------------------------------------------------------------------------------
-- No example provided, see V4 Fortuna above instead.

--------------------------------------------------------------------------------
                                  V75
A V75 bet is specified in the same way as a V4 bet with the following
differences:
* There are 7 legs instead of 4
* You can select to "Boost" the bet, see example below.
* You cannot specify the X3, and X4 multipliers on a V75 but only X1, X2, X5,
  X10, X20, X50, and X100.
--------------------------------------------------------------------------------
Bet V75: V75B1.
  Account AA2.
  Boost.
  V75-1: 2, 3 R 4, 5.
  V75-2: 1 R 2, 3.
  V75-3: 1 R 2, 3.
  V75-4: 2, 3 R 6, 7.
  V75-5: 2, 3 R 6, 7.
  V75-6: 2, 3 R 6, 7.
  V75-7: 2, 3 R 6, 7.

--------------------------------------------------------------------------------
                              V75 Fortuna
A V75 Fortuna bet is specified in the same way as a V4 Fortuna bet with the
following difference:
* There are 7 legs instead of 4
* You can select to "Boost" the bet, see example above under V75.
--------------------------------------------------------------------------------
-- No example provided, see V4 above instead.

--------------------------------------------------------------------------------
                                  V86/V8
A V86 bet is specified in the same way as a V4 bet with the following
differences:
* There are 8 legs instead of 4
* You cannot specify the X3, and X4 multipliers on a V5 but only X1, X2, X5,
  X10, X20, X50, and X100.
* You can select to make the bet a V8 rather than a V86, in that case you
  simply specify the bet type as V86/8 rather than V86.
--------------------------------------------------------------------------------
-- No example provided, see V4 above instead.

--------------------------------------------------------------------------------
                              V86 Fortuna
A V86 Fortuna bet is specified in the same way as a V4 Fortuna bet with the
following difference:
* There are 8 legs instead of 4
A V86 Fortuna cannot be played as a V8.
--------------------------------------------------------------------------------
-- No example provided, see V4 Fortuna above instead.

--------------------------------------------------------------------------------
                                 Win
--------------------------------------------------------------------------------
  Bet Win: Win1 10.
    Leg-1: 2, 3.
--------------------------------------------------------------------------------
                                Place
--------------------------------------------------------------------------------
  Bet Place: Win1 10.
    Leg-1: 2, 3.

--------------------------------------------------------------------------------
                                Win & Place
--------------------------------------------------------------------------------
  Bet WP: WP1 10.
    Leg-1: 2, 3.

--------------------------------------------------------------------------------
                                Twin
--------------------------------------------------------------------------------
  Bet Twin: Twin1 5.
    Leg-1: 2, 3, 4 U 6, 7.
--------------------------------------------------------------------------------
                                Combo
--------------------------------------------------------------------------------
  Bet Combo: Combo1 10.
    Leg-1: 2, 3 S 4, 5.

--------------------------------------------------------------------------------
                                Triple
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                              Triple Flex
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                Rocket
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
                                Lucky 7
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
                                French
                                Win/Place
                                Twin
--------------------------------------------------------------------------------



  Check Odds:
  Check Coupon
  Check Dividends
  Leg 2:
    (3, 4),
    1,
    2,
    3,

-- End of example
